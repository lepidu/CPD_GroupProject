<html>
    <head>
        <title>List of Visas</title>
        <link rel="stylesheet" type="text/css" href="../css/style.css">
        <script src="/js/main.js"></script>
    </head>
    <body>
        <h1> Visas waiting list: </h1>
            <div id="waiting_list"></div>                
    <script>
        
        const electron = require("electron");
        const { ipcRenderer } = electron;

        ipcRenderer.send("visa:request:type");
        
        //ipcRender open like a second window the request:today
        ipcRenderer.on("visa:response:type", (event, appointments) => {
            const listDiv = document.getElementById("waiting_list");
            listDiv.innerHTML = "";
        
        //Show the information to the request
        appointments.forEach(visa => {
            const appointmentDiv = document.createElement("div");

            const nameParagraph = document.createElement("p");
            nameParagraph.innerHTML = `Name: ${visa.name}`;
            
            const numberParagraph = document.createElement("p");
            numberParagraph.innerHTML = `Phone Number: ${visa.number}`;
            
            const dateParagraph = document.createElement("p");
            dateParagraph.innerHTML = `Date: ${visa.date}`;
            
            const timeParagraph = document.createElement("p");
            timeParagraph.innerHTML = `Time: ${visa.time}`;
            
            const symptomsParagraph = document.createElement("p");
            symptomsParagraph.innerHTML = `Symptoms: ${visa.symptoms}`;
            
            const doneParagraph = document.createElement("p");
            doneParagraph.innerHTML = `Done: ${visa.done ? "Yes" : "No"}`;
            
            //Button done is created
            const doneButton = document.createElement("button");
            doneButton.innerHTML = "Done";
            doneButton.disabled = appointment.done ? true : false;
            doneButton.onclick = () => done(visa.id);
            
            //Store in the file db.json
            visaDiv.appendChild(nameParagraph);
            visaDiv.appendChild(numberParagraph);
            visaDiv.appendChild(dateParagraph);
            visaDiv.appendChild(timeParagraph);
            visaDiv.appendChild(symptomsParagraph);
            visaDiv.appendChild(doneParagraph);
            visaDiv.appendChild(doneButton);
 
            listDiv.append(visaDiv);
        });
    });
        const done = id => {
            ipcRenderer.send("visa:done", id);
        };
            </script>            
    </body>
</html>